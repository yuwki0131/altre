# ADR 0007: Tauri ベース GUI フロントエンド方針

- **日付**: 2025-03-15
- **ステータス**: 承認済み（実装準備中）

## 背景
- ADR 0005/0006 で採用していた Slint GUI は 2025-03-15 時点で撤去済み。
- CLI/ターミナル主体の検証フローを維持しつつ GUI を再導入する必要がある。
- QA セクション（Q28〜Q35）で Tauri 採用時の課題と回答を整理し、当面の方針が固まった。

## 決定
1. **フロントエンド構成**  
   - Rust バックエンド（既存 `src/`）を起動エントリとし、Tauri の `src-tauri` は重複を避けたディレクトリ名に調整する。  
   - Web フロントエンド資産は `frontend/` 配下に専用ディレクトリを設けて管理する。

2. **技術スタック**  
   - Tauri Web フロントエンドは React を採用する。  
   - Rust 側の `Backend` を `tauri::State` で共有し、コマンド経由の同期呼び出しとイベント送出 (`emit_all`) を併用する。

3. **入力・表示モデル**  
   - フロントエンドは極力薄く保ち、キーイベントはバックエンドに渡して解決する。  
   - 画面更新は初期実装として pull 型スナップショット API を採用し、性能要件に応じて push 型へ拡張する。

4. **ファイルアクセスとログ**  
   - ファイル I/O は Rust 側で完結させ、Tauri プラグイン (`fs`) は利用しない。  
   - GUI デバッグログは `~/.altre-log/debug.log` 配下に出力し、CLI からの参照を容易にする。CLI オプションで出力制御を行う。

5. **ビルド・テスト前提**  
   - Node.js / npm 依存は NixOS 環境を前提に整備し、問題発生時はエラー内容を記録する。  
   - オフライン運用については別途検討するが、まずはオンライン環境で動作確認を行う。

## 影響
- モノレポ構成をワークスペース化する必要がある（Rust/Tauri/フロントエンドのビルド連携）。  
- 既存の `Frontend` モジュールに Tauri アダプタを追加するための抽象化見直しが必要。  
- デバッグログ CLI オプションと出力先ディレクトリ作成処理の追加が必要。  
- Node.js 依存を含むビルド手順をドキュメント (`README.md` / `manuals/`) に追記する必要がある。

## フォローアップ
- 設計詳細のドキュメント化（Tauri アーキテクチャ、キーイベントフロー、API 仕様）。  
- 実装タスク群の着手（プロジェクト構成整備、React ベース UI モック、バックエンド連携 API）。  
- Tauri 向けテスト / デバッグ手順の整備。
