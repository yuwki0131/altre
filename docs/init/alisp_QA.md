# 未決定事項のQA表
## Q1: alisp初期リリースの対象機能
- 質問: 初期実装ではフックやメジャーモード/マイナーモード、プロセス管理、フェイス、テキストプロパティなども揃える想定でしょうか？それとも段階的に導入する優先順が決まっていますか？
- 背景: A_LISP_FIRST_DRAFT.mdではEmacs並みの機能群が列挙されていますが、初期スコープが不明なため実装計画が立てづらいです。

### Answer

初期実装ではフックやメジャーモード/マイナーモード、プロセス管理、フェイス、テキストプロパティなどは将来的な実装を行います。まずは原始的な言語機能とそれを動作確認できる機能を実装することを目指します。
原始的な言語機能とは、などを関数定義や四則演算などの基本的な機能、関数や変数の定義やスコーピング、四則演算やプリミティブ型に対するデータ操作を指します。
原始的な言語機能と基本的な出力(ミニバッファへのメッセージ出力)、ミニバッファによるeval実行(minibufferにalispのコードを入力入力→minibufferに出力で動作確認を行います)
interactive機能の実装やキーバインド等のAPIも後回しにしてください。

## Q2: バイトコードコンパイルの扱い
- 質問: `byte-compile-file`によるバイトコンパイルと`.elc`読み込みは初期版本体で対応しますか？対応する場合、バイトコード命令セットやVMは既存仕様を踏襲するのか、新規設計が必要なのかを教えてください。
- 背景: 初期段階からインタプリタとJIT/VMを併用するかどうかで必要な実装工数が大きく変わります。

### Answer

初期は原始的なインタープリタ(バイトコードインタプリタですらなくていいです)でいいです。構文解析木後のASTのデータ構造を単純に走査するタイプで良いです。VMの設計やバイトコード仕様は
将来的に実装していきます。現段階でのバージョンでは不要です。

## Q3: パッケージ管理互換性
- 質問: `package.el`や`straight.el`互換とありますが、Emacs用リポジトリ(ELPA/MELPA)をそのまま利用する方針でしょうか？それともAltre専用レジストリを用意し、互換APIのみ提供する想定ですか？
- 背景: ネットワークアクセス要件や依存関係解決ロジックの設計に影響するため、互換範囲を把握したいです。

### Answer

すみません、`package.el`や`straight.el`互換の箇所はテキストの削除漏れです。今回実装するalispではパッケージ配布は考慮しません。(将来的に検討する可能性はあります)

## Q4: 言語仕様の詳細
- 質問: 数値型は整数/浮動小数/任意精度などどこまでを標準でサポートしますか？また、マクロ・クォート/アンコート構文は標準装備と考えてよいでしょうか？
- 背景: 基本型リストに「数値」のみ記載があり細分類が不明なほか、Lispとして必須のマクロが仕様に明記されていないため確認したいです。


### Answer

数値型は、整数/浮動小数(Javaのdouble相当、IEEE 754 標準)の2つのみサポート、
マクロ、クォートなどの構文は今回実装分では実装しない整理としてください。将来的に実装する機能の扱いとします。

## Q5: メモリ管理とGC
- 質問: ドキュメントではRust/CレイヤがGCなど低レベル機能を提供するとありますが、alisp用GCはRust側で新規実装予定でしょうか？マークアンドスイープ等の方式やリアルタイム性要件があれば教えてください。
- 背景: インタプリタ設計においてGCインターフェースの前提が重要なため早めに仕様を固めたいです。

### Answer

GCは実装してください。新規実装で大丈夫ですが、ここは現時点では特に要件はないため、ここの設計や性能要件は、技術方式はお任せします。ただし、設計文書には何の方式で実装するかという方針の記載はほしいです。

## Q6: 初期実装で扱うデータ型と評価エントリポイント
- 質問: 初期スコープではデータ型をどこまで揃える必要がありますか？ドラフトではリスト/ベクタ/ハッシュテーブルまで列挙されていますが、最初のリリースでここまで実装しますか？また、コード実行はミニバッファ経由の即時評価のみで十分でしょうか、それとも`eval-buffer`や`eval-region`も初期対応しますか？
- 背景: 実装範囲を確定させたいので、サポート対象のコレクション型とエントリポイントの優先順位を知りたいです。

### Answer

それでは、リスト、ベクタ、ハッシュテーブルの実装は初期実装から外すこととしましょう。サポートするコレクション型の優先順位としては、リスト > ハッシュテーブル > ベクタ という順序です。

## Q7: 評価エントリポイントの初期範囲
- 質問: 初期実装ではミニバッファ経由の一行評価だけで十分でしょうか？それとも`eval-buffer`や`eval-region`のようなバッファ単位/リージョン単位の評価コマンドも最初から用意しておくべきでしょうか？
- 背景: 評価経路の数によってUI側との接続やテスト対象が大きく変わるため、最小構成を明確にしたいです。

### Answer

eval-bufferとeval-regionは初期である今回は不要です。将来的には機能として組み込むことを考えています。

## Q8: ミニバッファ連携先のUI実装について
- 質問: 現在のリポジトリにはTUI本体（ratatuiベースの画面描画やミニバッファ表示）が存在していないようですが、alispのread/eval/printを統合する対象は別ブランチにあるでしょうか？それとも本タスクでは新規にTUI層を実装するところから着手が必要でしょうか？
- 背景: docsではミニバッファ仕様が定義されていますが、app/src 以下に対応するUI実装が見当たらず、統合先が不明なため作業を進められません。

### Answer

最新のmainブランチにratatuiベースのUIおよびミニバッファ実装が揃っており、feature/alispへ取り込むことで統合可能になりました。`app/src/app.rs` を中心とした既存UI層を連携先として利用してください。
