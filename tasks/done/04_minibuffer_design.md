# ミニバッファ設計

## タスク概要
MVPで実装するミニバッファシステムの設計を行う。

## 目的
- Emacs風ミニバッファによるコマンド入力インターフェース
- ファイル操作時の直感的なパス入力・補完機能
- エラーメッセージの適切な表示機能
- キーバインドシステムとの連携

## 設計対象
1. **ミニバッファアーキテクチャ**
   - 表示領域とレイアウト
   - 入力状態の管理
   - イベント処理フロー
   - メインエディタとの連携

2. **入力処理システム**
   - テキスト入力とカーソル管理
   - 特殊キー処理（Tab、Enter、C-g等）
   - 履歴機能の基本設計
   - 入力バリデーション

3. **補完システム**
   - ファイルパス補完アルゴリズム
   - 候補表示UI
   - 絞り込み機能
   - パフォーマンス考慮事項

4. **状態管理**
   - ミニバッファモードの種類
   - アクティブ/非アクティブ状態
   - エラー状態の表現
   - キャンセル処理

## 成果物
- `docs/design/minibuffer.md` - 設計仕様書
- `app/src/minibuffer/mod.rs` - インターフェース定義
- 補完アルゴリズムの仕様

## QA要確認事項
- ミニバッファのレイアウト位置（画面下部固定？）
- 補完候補の表示数上限
- 履歴機能の詳細範囲（MVP では簡易版？）
- エラーメッセージの表示時間
- 非同期ファイル操作との連携

## 完了条件
- [x] ミニバッファUI設計の確定
- [x] 入力処理フローの設計完成
- [x] 補完システム仕様の策定
- [x] キーバインド連携の設計
- [x] エラーハンドリング方針の確定

## 見積もり
**期間**: 2-3日
**優先度**: 高（ユーザーインターフェース の重要要素）

## 関連タスク
- 03_keybinding_design.md（前提）
- 05_minibuffer_implementation.md（実装）
- 06_file_operations_implementation.md（統合）

## 技術的考慮事項
- crossterm での画面レイアウト制御
- 非同期入力処理
- Unicode文字の適切な処理
- メモリ効率（補完候補のキャッシュ）
- ファイルシステムAPIとの統合