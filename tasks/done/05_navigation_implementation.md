# ナビゲーション機能実装

## タスク概要
設計仕様に基づいてナビゲーション（カーソル移動）機能を実装する。

## 目的
- 高速応答性（< 1ms）のカーソル移動の実現
- Emacs風キーバインドとの完全互換性
- UTF-8文字対応の正確なナビゲーション
- 画面表示との効率的な統合

## 実装対象
1. **ナビゲーションシステム**
   - `NavigationSystem`の実装
   - 基本移動操作（C-f, C-b, C-n, C-p）
   - 行内移動（C-a, C-e）
   - バッファ全体移動（M-<, M->）

2. **位置計算エンジン**
   - `PositionCalculator`の高性能実装
   - O(log n)行インデックスキャッシュ
   - Tab幅考慮の表示幅計算
   - 長い行での最適化（QA Q22対応）

3. **画面表示統合**
   - `ViewportManager`の実装
   - 中央配置スクロール（QA Q23対応）
   - ratatui座標系との変換
   - 効率的な画面更新

4. **境界処理・エラーハンドリング**
   - ファイル先頭・末尾での境界処理
   - UTF-8文字境界での安全な操作
   - パフォーマンス制約違反の処理

## 成果物
- `src/buffer/navigation.rs` - 完全実装
- `src/ui/viewport.rs` - ビューポート管理
- 位置計算アルゴリズム
- 包括的なテストスイート

## 前提条件
- 09_navigation_design.mdの完了
- QA.mdの回答（Q21, Q22, Q23）
- ギャップバッファ実装の完了

## 完了条件
- [ ] NavigationSystemの完全実装
- [ ] PositionCalculatorの高性能実装
- [ ] ViewportManagerの実装
- [ ] UTF-8安全性の保証
- [ ] パフォーマンス目標の達成（< 1ms）
- [ ] 長い行での最適化実装
- [ ] 境界処理の完全実装
- [ ] 全テストの成功

## 見積もり
**期間**: 3-4日
**優先度**: 高（コア機能）

## 関連タスク
- 09_navigation_design.md（前提）
- 03_gap_buffer_implementation.md（前提）
- 04_tui_interface_implementation.md（統合先）

## 技術的考慮事項
- QA回答に基づく設計方針（Tab幅4、段階的制限、中央配置）
- ギャップバッファとの効率的な統合
- 日本語・絵文字の正確な文字幅計算
- ratatui座標系との効率的な変換