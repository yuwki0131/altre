# ファイル操作実装

## タスク概要
ファイルの読み込み、保存、新規作成機能を実装する。

## 目的
- 安全なファイルI/O操作の実現
- UTF-8エンコーディングの確実な処理
- エラー状況での適切な処理
- ユーザーデータの保護

## 実装対象
1. **ファイル読み込み**
   - UTF-8テキストファイルの読み込み
   - 大きなファイルの効率的な処理
   - ファイル存在確認
   - 読み込み権限チェック

2. **ファイル保存**
   - 既存ファイルの上書き保存
   - 新規ファイルの作成
   - バックアップ作成（簡易版）
   - 書き込み権限チェック

3. **パス処理**
   - 相対パス・絶対パスの正規化
   - ホームディレクトリ展開（~）
   - ディレクトリ自動作成
   - パス検証

4. **エラーハンドリング**
   - ファイル不存在エラー
   - 権限不足エラー
   - ディスク容量不足エラー
   - エンコーディングエラー

## テスト実装
1. **単体テスト**
   - ファイル読み込み機能
   - ファイル保存機能
   - パス正規化処理
   - エラーケース処理

2. **統合テスト**
   - 読み込み→編集→保存の完全フロー
   - 各種エラー状況の処理確認

## 成果物
- `src/file/mod.rs`
- `src/file/io.rs`
- `src/file/path.rs`
- `tests/file_tests.rs`

## 前提条件
- 05_minibuffer_implementation.md の完了
- 06_error_handling_design.md の完了
- 01_project_structure_setup.md の完了

## 完了条件
- [x] ファイル読み込み機能の実装完成
- [x] ファイル保存機能の実装完成
- [x] パス処理機能の実装完成
- [x] エラーハンドリングの実装完成
- [x] 全テストの成功

## 見積もり
**期間**: 2-3日
**優先度**: 高（基本機能）

## 関連タスク
- 05_minibuffer_implementation.md（前提）
- 07_main_application_integration.md（統合先）

## 技術的考慮事項
- std::fs での安全なファイル操作
- shellexpand でのパス展開
- 原子的なファイル保存（一時ファイル→リネーム）
- UTF-8 BOM の適切な処理
